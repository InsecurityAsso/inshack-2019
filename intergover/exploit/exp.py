from pwn import * 
from sys import exit

def extract_flag(s):
    idx = s.find("INSA{")
    if idx == -1:
        return None
    
    idx2 = s.find("}")
    if idx == -1:
        return None
    
    return s[idx+5:idx2]

if os.getenv("DEV") == "1":
    host = "localhost"
else:
    host = "intergover.ctf.insecurity-insa.fr"

keyfile = "keys/id_rsa"
s = ssh(user="user", host=host, port=2223, keyfile=keyfile)
sh = s.shell()
sh.sendline("242")

sh.recvline()
flag = sh.recvline().decode()
print(flag)

import re
actual_flag = re.findall(r'INSA{.*}', open('../.mkctf.yml').read())[0]
assert actual_flag in flag
