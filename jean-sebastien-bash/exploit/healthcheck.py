from pwn import *
import os 
import re

if os.getenv("dev") == '1':
    host = 'localhost'
else:
    host = 'jean-sebastien-bash.ctf.insecurity-insa.fr'

s = ssh(host=host, port=2227, keyfile='keys/id_rsa', user='user')
shell = s.shell()

print(shell.readline())
print(shell.readline())
shell.sendline('/cmd 24850b91d0869089b21aa0e77919ea3861616161616161616161616161616161')
print(shell.readline())
print(shell.readline())
print(shell.readline())
output = shell.readline()
output += shell.readline()
print(shell.readline())

shell.sendline('/exit')
print(shell.readline())
print(shell.readline())

s.close()

flag = re.findall(r'INSA{.+}', open('../.mkctf.yml').read())[0]
assert flag.encode() in output
