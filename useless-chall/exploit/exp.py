from pwn import *
import os

if os.getenv("DEV") == "1":
    host = "localhost"
else:
    host = "useless-chall.ctf.insecurity-insa.fr"

s = ssh(user="user", host=host, port=2230, password="user")
sh = s.shell()

sh.sendline("INSA{I_kN0w_U_l0v3_Us3l3sS_H4sH_FuNcT10n}")
print(sh.recvline())
print(sh.recvline())
flag = sh.recvline().decode()

import re
actual_flag = re.findall(r'INSA{.*}', open('../.mkctf.yml').read())[0]
assert actual_flag in flag
