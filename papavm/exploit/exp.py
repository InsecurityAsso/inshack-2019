from pwn import *
import os

if os.getenv("DEV") == "1":
    host = "localhost"
else:
    host = "papavm.ctf.insecurity-insa.fr"

s = ssh(user="user", host=host, port=2231, password="user")
sh = s.shell()

sh.sendline("INSA{P4p4VM_w4Z_r34llY_4m4z1nG_I_L0v3_1t}")
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
print(sh.recvline())
flag = sh.recvline().decode()
print("FLAG: " + flag)

import re
actual_flag = re.findall(r'INSA{.*}', open('../.mkctf.yml').read())[0]
assert actual_flag in flag
